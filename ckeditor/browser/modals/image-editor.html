<html>
<head lang="en">
	<meta charset="UTF-8">
	<title>CamanJS demo</title>
	<!-- <script src="https://code.jquery.com/jquery-2.1.3.min.js"></script>
	<script src="https://code.jquery.com/ui/1.11.1/jquery-ui.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/camanjs/4.1.1/caman.full.min.js"></script>
	<link rel="stylesheet" href="https://code.jquery.com/ui/1.11.2/themes/smoothness/jquery-ui.css"> -->
	<style>
		body {
			font-family: Arial, sans-serif;
			margin: 30px;
		}
		label {
			font-size: 0.9em;
			margin: 10px 0 5px;
			display: block;
			position: relative;
		}
		.v {
			position: absolute;
			right: 0;
			font-size: 0.7em;
			color: #aaa;
		}
		#left-col {
			float: left;
			width: 250px;
			font-size: 0.7em;
		}
		button {
			margin: 5px 5px 0 0;
		}
	</style>
</head>
<body>
<div id="image-edtior">
	<div id="left-col">
		<div id="accordion" class="ui-accordion ui-widget ui-helper-reset" role="tablist">
			<h3 class="ui-accordion-header ui-state-default ui-accordion-icons ui-corner-all" role="tab" id="ui-id-1" aria-controls="ui-id-2" aria-selected="false" aria-expanded="true" tabindex="0"><span class="ui-accordion-header-icon ui-icon ui-icon-triangle-1-e"></span>Adjust</h3>
			<div class="ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom" id="ui-id-2" aria-labelledby="ui-id-1" role="tabpanel" aria-hidden="true" style="display: none; height: 245.36px;">
				<label>Brightness <span class="v" id="v-brightness">0</span></label>
				<div class="slider ui-slider ui-slider-horizontal ui-widget ui-widget-content ui-corner-all" id="brightness" data-min="-100" data-max="100" data-val="0"><span class="ui-slider-handle ui-state-default ui-corner-all" tabindex="0" style="left: 50%;"></span></div>
				<label>Contrast <span class="v" id="v-contrast">0</span></label>
				<div class="slider ui-slider ui-slider-horizontal ui-widget ui-widget-content ui-corner-all" id="contrast" data-min="-100" data-max="100" data-val="0"><span class="ui-slider-handle ui-state-default ui-corner-all" tabindex="0" style="left: 50%;"></span></div>
				<label>Saturation <span class="v" id="v-saturation">0</span></label>
				<div class="slider ui-slider ui-slider-horizontal ui-widget ui-widget-content ui-corner-all" id="saturation" data-min="-100" data-max="100" data-val="0"><span class="ui-slider-handle ui-state-default ui-corner-all" tabindex="0" style="left: 50%;"></span></div>
				<label>Vibrance <span class="v" id="v-vibrance">0</span></label>
				<div class="slider ui-slider ui-slider-horizontal ui-widget ui-widget-content ui-corner-all" id="vibrance" data-min="-100" data-max="100" data-val="0"><span class="ui-slider-handle ui-state-default ui-corner-all" tabindex="0" style="left: 50%;"></span></div>
				<label>Exposure <span class="v" id="v-exposure">0</span></label>
				<div class="slider ui-slider ui-slider-horizontal ui-widget ui-widget-content ui-corner-all" id="exposure" data-min="-100" data-max="100" data-val="0"><span class="ui-slider-handle ui-state-default ui-corner-all" tabindex="0" style="left: 50%;"></span></div>

				<label>Clip <span class="v" id="v-clip">0</span></label>
				<div class="slider ui-slider ui-slider-horizontal ui-widget ui-widget-content ui-corner-all" id="clip" data-min="0" data-max="100" data-val="0"><span class="ui-slider-handle ui-state-default ui-corner-all" tabindex="0" style="left: 0%;"></span></div>
				<label>Hue <span class="v" id="v-hue">0</span></label>
				<div class="slider ui-slider ui-slider-horizontal ui-widget ui-widget-content ui-corner-all" id="hue" data-min="0" data-max="100" data-val="0"><span class="ui-slider-handle ui-state-default ui-corner-all" tabindex="0" style="left: 0%;"></span></div>
				<label>Sepia <span class="v" id="v-sepia">0</span></label>
				<div class="slider ui-slider ui-slider-horizontal ui-widget ui-widget-content ui-corner-all" id="sepia" data-min="0" data-max="100" data-val="0"><span class="ui-slider-handle ui-state-default ui-corner-all" tabindex="0" style="left: 0%;"></span></div>
				<label>Noise <span class="v" id="v-noise">0</span></label>
				<div class="slider ui-slider ui-slider-horizontal ui-widget ui-widget-content ui-corner-all" id="noise" data-min="0" data-max="100" data-val="0"><span class="ui-slider-handle ui-state-default ui-corner-all" tabindex="0" style="left: 0%;"></span></div>
				<label>Sharpen <span class="v" id="v-sharpen">0</span></label>
				<div class="slider ui-slider ui-slider-horizontal ui-widget ui-widget-content ui-corner-all" id="sharpen" data-min="0" data-max="100" data-val="0"><span class="ui-slider-handle ui-state-default ui-corner-all" tabindex="0" style="left: 0%;"></span></div>
			</div>
			<h3 class="ui-accordion-header ui-state-default ui-accordion-icons ui-corner-all" role="tab" id="ui-id-3" aria-controls="ui-id-4" aria-selected="false" aria-expanded="false" tabindex="-1"><span class="ui-accordion-header-icon ui-icon ui-icon-triangle-1-e"></span>Resize</h3>
			<div class="ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom" id="ui-id-4" aria-labelledby="ui-id-3" role="tabpanel" aria-hidden="true" style="display: none; height: 245.36px;">
				<label>Width</label><input value="300" id="resize-w">
				<label>Height</label><input value="200" id="resize-h">
				<br>
				<button id="resize" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" role="button"><span class="ui-button-text">Apply</span></button>
			</div>
			<h3 class="ui-accordion-header ui-state-default ui-accordion-icons ui-corner-all" role="tab" id="ui-id-5" aria-controls="ui-id-6" aria-selected="false" aria-expanded="true" tabindex="0"><span class="ui-accordion-header-icon ui-icon ui-icon-triangle-1-e"></span>Crop</h3>
			<div class="ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom" id="ui-id-6" aria-labelledby="ui-id-5" role="tabpanel" aria-hidden="true" style="display: none; height: 245.36px;">
				<label>X</label><input value="100" id="crop-x">
				<label>Y</label><input value="100" id="crop-y">
				<label>Width</label><input value="400" id="crop-w">
				<label>Height</label><input value="300" id="crop-h">
				<br>
				<button id="crop" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" role="button"><span class="ui-button-text">Apply</span></button>
			</div>
			<h3 class="ui-accordion-header ui-state-default ui-corner-all ui-accordion-icons" role="tab" id="ui-id-7" aria-controls="ui-id-8" aria-selected="false" aria-expanded="false" tabindex="-1"><span class="ui-accordion-header-icon ui-icon ui-icon-triangle-1-e"></span>Rotate</h3>
			<div class="ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom" id="ui-id-8" aria-labelledby="ui-id-7" role="tabpanel" aria-hidden="true" style="display: none; height: 245.36px;">
				<button id="rotate-cw" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" role="button"><span class="ui-button-text">Rotate CW</span></button>
				<button id="rotate-ccw" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" role="button"><span class="ui-button-text">Rotate CCW</span></button>
			</div>
			<h3 class="ui-accordion-header ui-state-default ui-accordion-icons ui-corner-all" role="tab" id="ui-id-9" aria-controls="ui-id-10" aria-selected="false" aria-expanded="true" tabindex="0"><span class="ui-accordion-header-icon ui-icon ui-icon-triangle-1-e"></span>Presets</h3>
			<div class="ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom" id="ui-id-10" aria-labelledby="ui-id-9" role="tabpanel" aria-hidden="true" style="display: none; height: 245.36px;">
				<button class="preset ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" data-preset="clarity" role="button"><span class="ui-button-text">Clarity</span></button>
				<button class="preset ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" data-preset="pinhole" role="button"><span class="ui-button-text">Pinhole</span></button>
				<button class="preset ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" data-preset="love" role="button"><span class="ui-button-text">Love</span></button>
				<button class="preset ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" data-preset="jarques" role="button"><span class="ui-button-text">Jarques</span></button>
				<button class="preset ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" data-preset="orangePeel" role="button"><span class="ui-button-text">Orange Peel</span></button>
				<button class="preset ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" data-preset="sinCity" role="button"><span class="ui-button-text">Sin City</span></button>
				<button class="preset ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" data-preset="grungy" role="button"><span class="ui-button-text">Grungy</span></button>
				<button class="preset ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" data-preset="oldBoot" role="button"><span class="ui-button-text">Old Boot</span></button>
				<button class="preset ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" data-preset="lomo" role="button"><span class="ui-button-text">Lomo</span></button>
				<button class="preset ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" data-preset="vintage" role="button"><span class="ui-button-text">Vintage</span></button>
				<button class="preset ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" data-preset="crossProcess" role="button"><span class="ui-button-text">Cross Process</span></button>
				<button class="preset ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" data-preset="concentrate" role="button"><span class="ui-button-text">Concentrate</span></button>
				<button class="preset ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" data-preset="glowingSun" role="button"><span class="ui-button-text">Glowing Sun</span></button>
				<button class="preset ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" data-preset="sunrise" role="button"><span class="ui-button-text">Sunrise</span></button>
				<button class="preset ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" data-preset="nostalgia" role="button"><span class="ui-button-text">Nostalgia</span></button>
				<button class="preset ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" data-preset="hemingway" role="button"><span class="ui-button-text">Hemingway</span></button>
				<button class="preset ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" data-preset="herMajesty" role="button"><span class="ui-button-text">Her Majesty</span></button>
				<button class="preset ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" data-preset="hazyDays" role="button"><span class="ui-button-text">Hazy Days</span></button>
			</div>
		</div>
		<div>
			<button id="reset" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" role="button"><span class="ui-button-text">Reset</span></button>
			<button id="save" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" role="button"><span class="ui-button-text">Save</span></button>
		</div>
	</div>

	<div id="image-area">
		<img style="margin: 50px auto; display: block; /*background: url(t.png)*/" id="imgz" src="" />
	</div>
</div>
<script>
	$(function() {
		$('#image-edtior #accordion').accordion({
			collapsible: true
		});

		$('#image-edtior button').button();

		var caman = Caman('#image-edtior #imgz');

		var rotation = 0;

		function applyFilters() {
			caman.revert(false);

			$('.slider').each(function() {
				var op = $(this).attr('id');
				var value = $(this).data('val');

				if (value === 0) {
					return;
				}

				caman[op](value);
			});
		}

		function resetFilters() {
			$('.slider').each(function() {
				var op = $(this).attr('id');

				$('#' + op).slider('option', 'value', $(this).attr('data-val'));
			});
		}

		$('#image-edtior .slider').each(function() {
			var op = $(this).attr('id');

			$('#' + op).slider({
				min: $(this).data('min'),
				max: $(this).data('max'),
				val: $(this).data('val'),
				change: function(e, ui) {
					$('#v-'+op ).html(ui.value);
					$(this).data('val', ui.value);

					if(e.originalEvent === undefined) {
						return;
					}

					applyFilters();
					caman.render();
				}
			});
		});

		$('#image-edtior #rotate-cw').click(function() {
			rotation += 90;
			caman.rotate(90);
			applyFilters();
			caman.render();
		});

		$('#image-edtior #rotate-ccw').click(function() {
			rotation -= 90;
			caman.rotate(-90);
			applyFilters();
			caman.render();
		});

		$('#image-edtior #resize').click(function() {
			caman.resize({
				width: $('#resize-w').val(),
				height: $('#resize-h').val()
			});
			applyFilters();
			caman.render();
		});

		$('#image-edtior #crop').click(function() {
			caman.crop(
				$('#crop-w').val(),
				$('#crop-h').val(),
				$('#crop-x').val(),
				$('#crop-y').val()
			);
			applyFilters();
			caman.render();
		});

		$('#image-edtior .preset').click(function() {
			resetFilters();
			var preset = $(this).data('preset');
			caman.revert(true);
			caman[preset]();
			caman.render();
		});

		$('#image-edtior #reset').click(function() {
			caman.reset();
			caman.render();
			resetFilters();
		});

		$('#image-edtior #save').click(function() {
            if (typeof handleImageEditorSaveButton === 'function') {
                handleImageEditorSaveButton(caman);
            } else {
                window.open(caman.toBase64());
            }
		});

	});
</script>
</body>
</html>
